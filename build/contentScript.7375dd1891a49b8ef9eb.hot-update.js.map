{"version":3,"file":"contentScript.7375dd1891a49b8ef9eb.hot-update.js","mappings":";;;;;;;;;;;AAAA;AACA;AACA;;AAGA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnFA","sources":["webpack://chrome-extension-boilerplate-react/./src/pages/Content/index.js","webpack://chrome-extension-boilerplate-react/webpack/runtime/getFullHash"],"sourcesContent":["// TODO: \n// 1. Testing\n// 2. check to see if the theme already exists in tab - if it is remove previous one.\n\n\ninit();\n\nfunction init() {\n  // Use regex on document to test for a Shopify site - https://github.com/Shopify/shopify-theme-inspector/blob/master/src/detectShopify.ts\n  const scripts = document.querySelectorAll('script');\n  for (let i = 0; i < scripts.length; i++) {\n    const content = scripts[i].textContent;\n\n    if (typeof content === 'string') {\n\n      if (/Shopify\\.shop\\s*=/.test(content)) {\n        console.log(content);\n\n        // eval(content)\n\n        const jsonString = content;\n\n        // Regular expression to match JSON objects from contents of script tag.\n        const regex = /{[^}]*}/g;\n        const objectsArray = jsonString.match(regex);\n\n        if (objectsArray) {\n          const parsedObjects = objectsArray.map(objectString => JSON.parse(objectString));\n          console.log(parsedObjects);\n\n          console.log(parsedObjects.filter((item) => item.id));\n          const theme = parsedObjects.filter((item) => item.id)[0]\n\n          const hostDomain = `https://${window.location.host}`;\n          const customiserUrl = `${hostDomain}/admin/themes/${theme.id}/editor`;\n          const previewUrl = `${hostDomain}/?preview_theme_id=${theme.id}`;\n          const themeData = [theme.name, previewUrl, customiserUrl, hostDomain];\n\n          addToExtension(themeData, 0, [])\n\n        } else {\n          console.log(\"No objects found in the string.\");\n        }\n\n        break;\n      }\n    }\n  }\n}\n\nfunction addToExtension(theme, themeCount, themeArr) {\n  // Get currently locally stored themes.\n  chrome.storage.local.get([\"themes\"]).then((result) => {\n    themeArr[themeCount] = {\n      themeHeading: theme[0],\n      previewLink: theme[1],\n      customiserLink: theme[2],\n      storeDomain: theme[3]\n    };\n\n    let combinedThemeArray;\n    let storedThemes = [];\n\n    if (result.themes) {\n      storedThemes = result.themes;\n    }\n\n    combinedThemeArray = [themeArr[themeCount], ...storedThemes];\n\n    chrome.storage.local.clear(function () {\n      var error = chrome.runtime.lastError;\n      if (error) {\n        console.error(error);\n      }\n      // Set storage after clearing existing.\n      chrome.storage.local.set({ themes: combinedThemeArray }).then(() => {\n        console.log(\"Links set\");\n      });\n\n    });\n    chrome.storage.sync.clear(); // callback is optional\n\n  });\n}","__webpack_require__.h = () => (\"f445dbb6d2c1be3dae2a\")"],"names":[],"sourceRoot":""}